

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>equations module &mdash; anisonet 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="landscape module" href="landscape.html" />
    <link rel="prev" title="configs module" href="configs.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> anisonet
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">anisonet</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="anisofy.html">anisofy module</a></li>
<li class="toctree-l2"><a class="reference internal" href="configs.html">configs module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configs.html#population-s-configuration">Population’s configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="configs.html#pathways-configuration">Pathways’ configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="configs.html#profile">Profile</a></li>
<li class="toctree-l4"><a class="reference internal" href="configs.html#synapse">Synapse</a></li>
<li class="toctree-l4"><a class="reference internal" href="configs.html#anisotropy">Anisotropy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">equations module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#noise-scaling">Noise scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#synaptic-model">Synaptic model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="landscape.html">landscape module</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulate.html">simulate module</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="viz.html">viz module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">anisonet</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">anisonet</a> &raquo;</li>
        
      <li>equations module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/equations.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="module-equations">
<span id="equations-module"></span><h1>equations module<a class="headerlink" href="#module-equations" title="Permalink to this heading">¶</a></h1>
<p>The equation module provides proper equation strings for both neuron and 
synapses. Note however, due to the existence of the stochastic background 
current, extra care must be paid when translating the code of NEST to Brian 
and vice versa.</p>
<section id="noise-scaling">
<h2>Noise scaling<a class="headerlink" href="#noise-scaling" title="Permalink to this heading">¶</a></h2>
<p>According to this <a class="reference external" href="https://nest-simulator.readthedocs.io/en/v3.3/model_details/noise_generator.html">notebook</a> in NEST a Gaussian <code class="docutils literal notranslate"><span class="pre">noise_generator</span></code> adds a 
constant current <span class="math notranslate nohighlight">\(I_j\)</span> for the inteval <span class="math notranslate nohighlight">\([t_j, t_j + \Delta t]\)</span> 
using a normal distribution:</p>
<div class="math notranslate nohighlight">
\[I_j = \mu + \sigma N(0,1)\]</div>
<p>With such an input, the total charge injected until time <span class="math notranslate nohighlight">\(t\)</span> is</p>
<div class="math notranslate nohighlight">
\[q(t)_{NEST} = \int_0^t I dt' = \mu t + \sigma \sum_{j=0}^n I_j \Delta t\]</div>
<p>where we have used the Riemann sum. The mean and variance of total charge are</p>
<div class="math notranslate nohighlight">
\[\begin{split}E[q(t)_{NEST}] = \mu t  \\
Var[q(t)_{NEST}] = 0 + \sigma^2 \Delta t^2 * n = (n\Delta t) \sigma^2 \Delta t =  t \sigma^2 \Delta t\end{split}\]</div>
<p>However, in Brian, the same stochastic current is modelled as Wiener processes (<span class="math notranslate nohighlight">\(dW \~ N(0, dt)\)</span>) whose
variance depends on the timestep <cite>dt</cite> (<a class="reference external" href="https://www.researchgate.net/publication/260254488_Equation-oriented_specification_of_neural_models_for_simulations">[2]</a>). Wrting the stochastic current in its <cite>Langevin form</cite>, we get:</p>
<div class="math notranslate nohighlight">
\[I_j = \mu + \sigma \zeta(t_j)\]</div>
<p>which gives rise to</p>
<div class="math notranslate nohighlight">
\[q(t)_{Brian} = \int_0^t I dt' = \mu t + \sigma \int_0^t \zeta(t') dt' = \mu t + \sigma W(t) \]</div>
<p>with <span class="math notranslate nohighlight">\(W(t)\)</span> being a Brownian trajectory. Thus, the mean and variance are</p>
<div class="math notranslate nohighlight">
\[\begin{split}E[q(t)_{Brian}] = \mu t  \\
Var[q(t)_{Brian}] = 0 + t \sigma^2\end{split}\]</div>
<p>As a result, the variance of Brian and NEST are related in the following way:</p>
<div class="math notranslate nohighlight">
\[\sigma^2_{Brian} = \sigma^2_{NEST} \Delta t_{NEST}\]</div>
</section>
<section id="synaptic-model">
<h2>Synaptic model<a class="headerlink" href="#synaptic-model" title="Permalink to this heading">¶</a></h2>
<p>There are three different conventional models for synapses:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>conductance-based,</p></li>
<li><p>current-based, and</p></li>
<li><p>voltage-based</p></li>
</ol>
</div></blockquote>
<p>which, from the both mathematical and implementation perspective have 
differences. From mathematical point of view, a conductance based synapse 
is governed by:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}I_{syn} = g_{max} g(t) (V_{post} - V_{pre})\\g(t) = \int_{-\infty}^t \sum_k f(t-t') \delta(t'-t_k) dt' = \sum_k f(t-t_k)\end{aligned}\end{align} \]</div>
<p>A current-based synapse, on the other hand, describes the synaptic current as:</p>
<div class="math notranslate nohighlight">
\[I_{syn} = I_{max} \int_{-\infty}^t \sum_k f(t-t') \delta(t'-t_k) dt' = I_{max} \sum_k f(t-t_k)\]</div>
<p>Finally, in voltage-based formulation we don’t describe the injected current, 
but directly the increment in the membrane voltage:</p>
<div class="math notranslate nohighlight">
\[\Delta V_{syn} = V_{max} \int_{-\infty}^t \sum_k f(t-t') \delta(t'-t_k) dt' =  V_{max} \sum_k f(t-t_k)\]</div>
<p>In all these formulations <span class="math notranslate nohighlight">\(f(t-t')\)</span> is a filter, often replaced by an 
exponential, bi-exponential (with rise and decay time <span class="math notranslate nohighlight">\(\tau_r\)</span> and 
<span class="math notranslate nohighlight">\(\tau_d\)</span>), and alpha function (equal rise and decay time), scaled by the
<span class="math notranslate nohighlight">\(_{max}\)</span> qunatites. <span class="math notranslate nohighlight">\(\sum \delta(.)\)</span> is the incoming spike train. 
Here we use the alpha function – scaled to a maximum of one – with the 
following system:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">dg/dt = -(g+h)/tau : 1</span>
<span class="sd">dh/dt = -h/tau :1</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="o">...</span>

<span class="n">on_pre</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;h += exp(1)&#39;&#39;&#39;</span>  <span class="c1"># takes care of the max-normalizing to 1</span>
</pre></div>
</div>
<p>Computationally, in Brian the first two require a <code class="docutils literal notranslate"><span class="pre">I_syn</span></code> term in the neuronal
equations that needs to be evaluated on every single timestep. One the 
contrary, voltage-based synapses only manipulate the potential of the 
post-synapse upon arrival of the presynaptic spike. Therefore, voltage-based 
synapse is computationally cheaper, immensely. In Brian, current/conductance-based 
synapses must be handled as <code class="docutils literal notranslate"><span class="pre">(clock-driven)</span></code> states whereas the voltage-based 
one can be computed in a <code class="docutils literal notranslate"><span class="pre">(event-driven)</span></code> fashion. Also look at 
(<a class="reference external" href="https://brian2.readthedocs.io/en/stable/user/synapses.html?highlight=event-driven#event-driven-updates">Brian documentation</a>) for more detail.</p>
<p>It’s however possible to transfer the current-based synapse to the voltage-based
one with the following assumption:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Asumption</strong>: The total current injected to the cell via a single spike 
leads to a  certain voltage increament. Setting <span class="math notranslate nohighlight">\(V_{max}\)</span> equal to 
this increment, we can make an voltage-based synapse from the current-based 
one.</p>
</div>
<p>This assumption leads to the scaling <span class="math notranslate nohighlight">\(V_{max} = \frac{I_{max} \tau_s}{C} e\)</span>.
(The facter e is due to scaling of alpha function.)</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This equivalence is not mathematically rigorous. A current-based method
computationally computes the voltage increment according to</p>
<div class="math notranslate nohighlight">
\[dv = \int \sum_k f(t-t_k) dt + ...\]</div>
<p>whereas a voltage based method as introduced above incorporates spikes as</p>
<div class="math notranslate nohighlight">
\[dv = \sum_k \int f(t-t_k) dt + ...\]</div>
<p>assuming that the spilkes are essentially independent. This assumption is 
true for sparse spiking patterns, or when <span class="math notranslate nohighlight">\(\tau_s \ll \tau_m\)</span>, meaning
that the membrane voltage is essentially in tact throughout the synaptic 
dynamics.</p>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="equations.get_nrn_eqs">
<span class="sig-prename descclassname"><span class="pre">equations.</span></span><span class="sig-name descname"><span class="pre">get_nrn_eqs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pop_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pops_cfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">syn_base</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/equations.html#get_nrn_eqs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#equations.get_nrn_eqs" title="Permalink to this definition">¶</a></dt>
<dd><p>It matters how the synapse inputs are modeled. Seemingly, the one used in
NEST and the paper are using a “current-alpha”, as opposed to “voltage-” or
“conductance-”. Look at <a class="reference external" href="https://github.com/nest/nest-simulator/blob/d7b3c7671c5fcd9acf211b58012db9729607a1db/models/iaf_psc_alpha.h#L48">source code</a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pop_name</strong> (<em>str</em>) – population name</p></li>
<li><p><strong>pops_cfg</strong> (<em>dict</em>) – population configuration</p></li>
<li><p><strong>syn_base</strong> (<em>str</em>) – synapse model base (infered from the config dicts)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Brian Equation object for neuron</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Brian Equation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="equations.get_syn_eqs">
<span class="sig-prename descclassname"><span class="pre">equations.</span></span><span class="sig-name descname"><span class="pre">get_syn_eqs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn_cfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">syn_base</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/equations.html#get_syn_eqs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#equations.get_syn_eqs" title="Permalink to this definition">¶</a></dt>
<dd><p>It matters how the synapse inputs are modeled. Seemingly, the one used in
NEST and the paper are using a “current-alpha”, as opposed to “voltage-” or
“conductance-”: <a class="reference external" href="https://github.com/nest/nest-simulator/blob/d7b3c7671c5fcd9acf211b58012db9729607a1db/models/iaf_psc_alpha.h#L48">nest repo</a>.</p>
<p>Nest normalizes its models according the the following rule (<a class="reference external" href="https://nest-simulator.readthedocs.io/en/v2.20.1/models/neurons.html#classnest_1_1iaf__psc__alpha">nest docs</a>):</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>iaf_psc_alpha</cite>: max current of unitary excitation/inhiition = 1 pA</p></li>
<li><p><cite>iaf_cond_alpha</cite>: max conductance of unitary excitation/inhiition = 1 nS</p></li>
</ul>
</div></blockquote>
<p>In order to get the same behaviour in brian, we need to ascribe a weight to
our unitary events. (This weight happen to be exp(1).) In addition, the 
parameter <code class="docutils literal notranslate"><span class="pre">h</span></code> is unbounded, and can be well beyond 1.</p>
<p>#TODO: check if that’s also the case in nest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conn_name</strong> (<em>str</em>) – pathway name</p></li>
<li><p><strong>conn_cfg</strong> (<em>dict</em>) – population connections configurations</p></li>
<li><p><strong>syn_base</strong> (<em>str</em>) – synapse model base (infered from the config dicts)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of (synapse equation, on_pre, on_post)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(Brian Equation object, str, str)</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="landscape.html" class="btn btn-neutral float-right" title="landscape module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="configs.html" class="btn btn-neutral" title="configs module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, Arash Gol-Mohammadi.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/documentation_options.js"></script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>